import csv

class Article:
    def __init__(self, name, price, quantity):
        self.name = name
        self.price = price
        self.quantity = quantity

class ShoppingCart:
    def __init__(self):
        self.inventory = {}
        self.cart = {}

    def load_inventory(self, filename):
        with open(filename, 'r') as file:
            reader = csv.reader(file)
            for row in reader:
                name, price, quantity = row
                self.inventory[name] = Article(name, float(price), int(quantity))

    def list_products(self):
        print("Product\t\tPrice\t\tQuantity")
        for product, article in self.inventory.items():
            print(product + "\t\t$" + str(article.price) + "\t\t" + str(article.quantity))

    def add_to_cart(self, product, quantity):
        if product in self.inventory:
            if self.inventory[product].quantity >= quantity:
                if product in self.cart:
                    self.cart[product]['quantity'] += quantity
                else:
                    self.cart[product] = {'price': self.inventory[product].price, 'quantity': quantity}
                self.inventory[product].quantity -= quantity
            else:
                print("Not enough quantity available.")
        else:
            print("Product not found in inventory.")

    def remove_from_cart(self, product):
        if product in self.cart:
            self.inventory[product].quantity += self.cart[product]['quantity']
            del self.cart[product]
        else:
            print("Product not found in cart.")

    def view_cart(self):
        print("Cart:")
        print("Product\t\tPrice\t\tQuantity")
        for product, details in self.cart.items():
            print(product + "\t\t$" + str(details['price']) + "\t\t" + str(details['quantity']))

    def checkout(self):
        total = 0
        for product, details in self.cart.items():
            price = details['price']
            quantity = details['quantity']
            if quantity >= 3:
                price *= 0.9  # Apply 10% discount
            total += price * quantity
        total *= 1.07  # Add 7% tax
        print("Total amount to be paid: $" + "{:.2f}".format(total))

if __name__ == "__main__":
    shopping_cart = ShoppingCart()
    shopping_cart.load_inventory('product.csv')

    while True:
        print("\nCommands: List, Cart, Add, Remove, Checkout")
        command = input("Enter a command: ").strip().lower()

        if command == "list":
            shopping_cart.list_products()
        elif command == "cart":
            shopping_cart.view_cart()
        elif command == "add":
            product = input("Enter product name: ").strip().lower()
            quantity = int(input("Enter quantity: "))
            shopping_cart.add_to_cart(product, quantity)
        elif command == "remove":
            product = input("Enter product name: ").strip().lower()
            shopping_cart.remove_from_cart(product)
        elif command == "checkout":
            shopping_cart.checkout()
            break
        else:
            print("Invalid command. Please try again.")
